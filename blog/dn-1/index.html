<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Disco Narrator - Data Scraping - 152334H</title><meta name=Description content="152334H Personal Blog"><meta property="og:title" content="Disco Narrator - Data Scraping"><meta property="og:description" content="To train an AI Text-To-Speech (TTS) model, we&rsquo;ll need to obtain a Labelled Dataset with two things:

Clean audio files (.wavs), containing only the voice we&rsquo;re cloning
The dialogue transcript (text) for each audio file
"><meta property="og:type" content="article"><meta property="og:url" content="https://152334H.github.io/blog/dn-1/"><meta property="og:image" content="https://152334H.github.io/undefined.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-09-11T00:00:00+01:00"><meta property="article:modified_time" content="2022-09-11T03:48:53+01:00"><meta property="og:site_name" content="152334H"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://152334H.github.io/undefined.png"><meta name=twitter:title content="Disco Narrator - Data Scraping"><meta name=twitter:description content="To train an AI Text-To-Speech (TTS) model, we&rsquo;ll need to obtain a Labelled Dataset with two things:

Clean audio files (.wavs), containing only the voice we&rsquo;re cloning
The dialogue transcript (text) for each audio file
"><meta name=application-name content="My cool site"><meta name=apple-mobile-web-app-title content="My cool site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://152334H.github.io/blog/dn-1/><link rel=prev href=https://152334H.github.io/blog/append-a-newline/><link rel=next href=https://152334H.github.io/blog/hosting-pwn-challenges/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Disco Narrator - Data Scraping","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/152334H.github.io\/blog\/dn-1\/"},"genre":"posts","keywords":"Disco Elysium, reverse engineering, part of a series, WIP","wordcount":1209,"url":"https:\/\/152334H.github.io\/blog\/dn-1\/","datePublished":"2022-09-11T00:00:00+01:00","dateModified":"2022-09-11T03:48:53+01:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"152334H"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"dark"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"dark"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=152334H>Simple Thoughts</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>All Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/about/><b>About </b></a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder=Search... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=152334H>Simple Thoughts</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=Search... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>All Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/about/ title><b>About</b></a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Disco Narrator - Data Scraping</h1><h2 class=single-subtitle>Part 1/4 of a <a href=/disco-narrator>series</a></h2><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://152334H.github.io/ title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>152334H</a></span>&nbsp;<span class=post-category>included in <a href=/categories/tech/><i class="far fa-folder fa-fw" aria-hidden=true></i>tech</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime="September 11, 2022">September 11, 2022</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;1209 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;6 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept=true><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#asset-extraction>Asset extraction</a></li><li><a href=#linking-audio-to-dialogue>Linking audio to dialogue</a><ul><li><a href=#dead-end-disco-courier>Dead-end: <code>disco-courier</code></a></li><li><a href=#further-sleuthing>Further sleuthing</a></li></ul></li></ul></nav></div></div><div class=content id=content><p>To train an AI Text-To-Speech (TTS) model, we&rsquo;ll need to obtain a Labelled Dataset with two things:</p><ol><li>Clean audio files (<code>.wav</code>s), containing only the voice we&rsquo;re cloning</li><li>The dialogue transcript (text) for each audio file</li></ol><p>I refer to these points as <code>(1)</code> and <code>(2)</code> in the next section.</p><h2 id=asset-extraction>Asset extraction</h2><p>Now, I&rsquo;ve never Reversed Engineered a Unity game before. But I knew, at bare minimum, that getting (2) done was definitely possible, because of <a href=https://disco-reader.gitlab.io/disco-reader target=_blank rel="noopener noreffer">Disco Reader</a> &ndash; a third-party app that renders dialogue trees from the game.</p><p>A bit of googling later, and I find an informative <a href=https://www.reddit.com/r/DiscoElysium/comments/kz66p3/_ target=_blank rel="noopener noreffer">reddit thread</a>:</p><blockquote><p>I needed a structured export of all the conversations in the game [&mldr;] <strong>I now use <a href=https://github.com/Perfare/AssetStudio target=_blank rel="noopener noreffer">AssetStudio</a> to extract the dialoguebundle myself.</strong></p></blockquote><p>While googling, I also found another project, <a href=https://github.com/htmlbanjo/disco-courier target=_blank rel="noopener noreffer">Disco Courier</a>, which suggested much of the same:</p><blockquote><p>place a copy of your <a href=https://github.com/Perfare/AssetStudio target=_blank rel="noopener noreffer">exported data</a> in /data/dialog.json</p></blockquote><p>So, I&rsquo;m looking to get a <code>.json</code> file from AssetStudio somehow. Let&rsquo;s try that.</p><hr><div class="details admonition info"><div class="details-summary admonition-title"><i class="icon fas fa-info-circle fa-fw" aria-hidden=true></i>Using AssetStudio<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><p>I <a href=https://github.com/Perfare/AssetStudio/releases/ target=_blank rel="noopener noreffer">download</a> and open the program. It looks like this:</p><p align=center><img src=Pasted%20image%2020220817194836.png></p><p>Okay, &ldquo;Load file/folder&rdquo;. The data has to be somewhere in the game files, so&mldr; I could try loading <code>Steam\steamapps\common\Disco Elysium\</code>, and look from there?</p><figure><a class=lightgallery href=/blog/dn-1/Pasted%20image%2020220817195617.png title=/blog/dn-1/Pasted%20image%2020220817195617.png data-thumbnail=/blog/dn-1/Pasted%20image%2020220817195617.png data-sub-html="<h2>uh oh</h2>"><div style=text-align:center><img style=height:ZgotmplZpx;width:ZgotmplZpx class=lazyload src=/svg/loading.min.svg data-src=/blog/dn-1/Pasted%20image%2020220817195617.png data-srcset="/blog/dn-1/Pasted%20image%2020220817195617.png, /blog/dn-1/Pasted%20image%2020220817195617.png 1.5x, /blog/dn-1/Pasted%20image%2020220817195617.png 2x" data-sizes=auto alt=/blog/dn-1/Pasted%20image%2020220817195617.png width=422 height=97></div></a><figcaption class=image-caption><strong>uh oh</strong></figcaption></figure><p>A crash and a reboot later, and I realise I should&rsquo;ve read the <code>README</code> in closer detail:</p><blockquote><p>When AssetStudio loads AssetBundles, it decompresses and reads it directly in memory, which may cause a large amount of memory to be used. You can use <strong>File-Extract file</strong> or <strong>File-Extract folder</strong> to extract AssetBundles to another folder, and then read.</p></blockquote><p>So I extracted the folder elsewhere, and <em>then</em> I tried <code>Load Folder</code>:</p><p align=center><img src=Pasted%20image%2020220817195953.png></p><p>The first thing I see are the audio files for the game. This is good &ndash; we&rsquo;ve solved for (1) &ndash; but I still haven&rsquo;t found the dialogue data yet.</p><p>After clicking around in the UI a bit, I luck out again: sorting the assets by size, I find an asset named <code>Disco Elysium</code>, stored at <code>/Assets/Dialogue Databases/Disco Elysium.asset</code>. Loading the <em>preview</em> for this asset nearly crashes my computer again because of how large it is &ndash; <strong>Every</strong> piece of writing (dialogue, thoughts, item descriptions, etc.) in the <strong>entire game</strong> is bundled in this one asset. Exported, this amounts to a 266MB <code>.json</code> file, as we expected earlier.</p></div></div></div><hr><p>After extracting the audio files as well, I have the following data:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>~/DiscoAudioSources$ tree 
</span></span><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>├── AudioClip
</span></span><span class=line><span class=cl>│   ├── Abandoned Lorry-JAM  INSTIGATOR CABIN-118.wav
</span></span><span class=line><span class=cl>│   ├── Abandoned Lorry-JAM  INSTIGATOR CABIN-120.wav
</span></span><span class=line><span class=cl>│   ├── Abandoned Lorry-JAM  INSTIGATOR CABIN-123.wav
</span></span><span class=line><span class=cl>.....
</span></span><span class=line><span class=cl>│   └── Yellow Man Mug-INVENTORY  MUG-9.wav
</span></span><span class=line><span class=cl>└── MonoBehaviour
</span></span><span class=line><span class=cl>    └── Disco Elysium.json
</span></span></code></pre></td></tr></table></div></div><p><code>AudioClip/</code> contains the files for (1), <code>MonoBehaviour/</code> contains the lines for (2).</p><h2 id=linking-audio-to-dialogue>Linking audio to dialogue</h2><p>I had <em>hoped</em> the <code>AudioClip</code> assets would contain some labelled metadata, but to my consternation, the audio files and dialogue text were bundled separately. So the <code>.wav</code> files themselves aren&rsquo;t very useful, and I need to gather more information.</p><p>Specifically, for each audio file, I need to know</p><ol><li>Which voice actor is speaking, and</li><li>What lines are being read</li></ol><h3 id=dead-end-disco-courier>Dead-end: <code>disco-courier</code></h3><p>The first thing I tried was to locate the information in <code>dialog.json</code>.</p><p>The <a href=https://github.com/htmlbanjo/disco-courier target=_blank rel="noopener noreffer">Disco Courier</a> project I mentioned earlier was made to work with it, so I started with an <code>npm install</code>:</p><figure><a class=lightgallery href=/blog/dn-1/Pasted%20image%2020220815203719.png title=/blog/dn-1/Pasted%20image%2020220815203719.png data-thumbnail=/blog/dn-1/Pasted%20image%2020220815203719.png data-sub-html="<h2>only 3 critical!</h2>"><div style=text-align:center><img style=height:60%;width:60% style=height:ZgotmplZpx;width:ZgotmplZpx class=lazyload src=/svg/loading.min.svg data-src=/blog/dn-1/Pasted%20image%2020220815203719.png data-srcset="/blog/dn-1/Pasted%20image%2020220815203719.png, /blog/dn-1/Pasted%20image%2020220815203719.png 1.5x, /blog/dn-1/Pasted%20image%2020220815203719.png 2x" data-sizes=auto alt=/blog/dn-1/Pasted%20image%2020220815203719.png width=581 height=261></div></a><figcaption class=image-caption>only 3 critical!</figcaption></figure><p>The app was a little bit old &ndash; last commit in 2021. 1 year is about two centuries long in the NodeJS ecosystem, so the app obviously crashed on first try:</p><p align=center><img src=Pasted%20image%2020220815203747.png></p><p>So, I did a little bit of debugging and added the fixes to <a href=https://github.com/152334H/disco-courier target=_blank rel="noopener noreffer">my fork</a>.</p><div class="details admonition bug"><div class="details-summary admonition-title"><i class="icon fas fa-bug fa-fw" aria-hidden=true></i>Details of the bug, if you care<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><p>To start, I grep the source for <code>the version of your data</code>, and quickly find the problem:</p><p align=center><img src=Pasted%20image%2020220815203916.png></p><p>The version is hardcoded&mldr; along with some metadata about the json file. I extracted these with a oneliner:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ fx src/data/dialog.json <span class=s1>&#39;d =&gt; ({version: d.version, rowCounts: { locations: d.locations.length, actors: d.actors.length, items: d.items.length, variables: d.variables.length, conversations: d.conversations.length }})&#39;</span>
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;version&#34;</span>: <span class=s2>&#34;5/20/2022 12:05:57 PM&#34;</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;rowCounts&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;locations&#34;</span>: 0,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;actors&#34;</span>: 424,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;items&#34;</span>: 259,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;variables&#34;</span>: 10645,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;conversations&#34;</span>: <span class=m>1501</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>And patched that output into the source. After that, I tried running the project with one of the suggested example commands:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ courier -- --export<span class=o>=</span>json --actor<span class=o>=</span><span class=m>3</span> --OR<span class=o>=</span><span class=nb>true</span> --conversant<span class=o>=</span><span class=m>6</span> conversations.dialog
</span></span><span class=line><span class=cl><span class=c1># &#34;Creates a detailed json export where the speaker is Kim, OR the conversant is Garte.&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>Naturally, this didn&rsquo;t do what it said it would do. After fixing another minor bug (the output directory, <code>./src/data/json</code>, did not exist), I found a list of conversations from The Player to Cunoesse at <code>./src/data/json/conversations/conversations.dialog.json</code>.</p></div></div></div><p>After accounting for bugs, I get a json file of dialogue entries from <code>courier</code>. A single dialog entry looks like this:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;parentId&#34;</span><span class=p>:</span> <span class=mi>1039</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;dialogId&#34;</span><span class=p>:</span> <span class=mi>222</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;isRoot&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;isGroup&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;refId&#34;</span><span class=p>:</span> <span class=s2>&#34;0x0100005A0000E5F6&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;isHub&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;dialogShort&#34;</span><span class=p>:</span> <span class=s2>&#34;Little Lily: \&#34;\&#34;Ll... Luby... Rr... R-luuby.\&#34; Sudd...\&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;dialogLong&#34;</span><span class=p>:</span> <span class=s2>&#34;\&#34;Ll... Luby... Rr... R-luuby.\&#34; Suddenly the girl gets all serious and leans in, as if she&#39;s about to tell you a secret.&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;actorId&#34;</span><span class=p>:</span> <span class=mi>101</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;actorName&#34;</span><span class=p>:</span> <span class=s2>&#34;Little Lily&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;conversantId&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;modifiers&#34;</span><span class=p>:</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;conditionPriority&#34;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;userScript&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;inputId&#34;</span><span class=p>:</span> <span class=s2>&#34;0x0100002100000B63&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;outputId&#34;</span><span class=p>:</span> <span class=s2>&#34;0x0100002100000B70&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>And although there&rsquo;s a lot of information in that entry, there&rsquo;s nothing that tells me what audio file (if any) this line is linked to. Dead end.</p><h3 id=further-sleuthing>Further sleuthing</h3><p>So, a third-party CLI app failed to give me the information I wanted. Maybe I should&rsquo;ve been a little less credulous, and checked the game files myself?</p><p>Answer: no, <code>disco-courier</code> is doing about the best it can. The only thing I really notice is that what the CLI app calls <code>refId</code>s <a href=http://pixelcrushers.com/dialogue_system/manual/html/articy_voice_over_plugin_details.html target=_blank rel="noopener noreffer">are named <code>articyId</code></a>s in the game files.</p><p>In desperation, I try to run <code>grep</code> on the raw assets to see if I&rsquo;d get anything.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>~/disco_Data$ grep <span class=s1>&#39;Ruud Hoenkloewen-PLAZA  KORTENAER-74&#39;</span> *
</span></span><span class=line><span class=cl>Binary file sharedassets1.assets matches
</span></span></code></pre></td></tr></table></div></div><p>To my surprise, it <em>did</em> find something. <code>sharedassets1</code>; what&rsquo;s in there?</p><p align=center><img src=Pasted%20image%2020220817202059.png></p>A lot of things, unfortunately. Let's try harder.<hr><div class="details admonition info"><div class="details-summary admonition-title"><i class="icon fas fa-info-circle fa-fw" aria-hidden=true></i>Shared Asset Extraction<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><p>As with before, let&rsquo;s start by sorting by size:</p><p align=center><img src=Pasted%20image%2020220817202143.png></p>That won't work; textures are big. Filter by <code>MonoBehaviour</code>?<p align=center><img src=Pasted%20image%2020220817202224.png><br><i>Hello.</i></p><p>I click on the asset, hit <code>Esc</code> after a file browser pop-up appears inexplicably, and I see:</p><p align=center><img src=Pasted%20image%2020220817202335.png><br>An empty object?</p><a class=lightgallery href=/blog/dn-1/Pasted%20image%2020220817202349.png title=/blog/dn-1/Pasted%20image%2020220817202349.png data-thumbnail=/blog/dn-1/Pasted%20image%2020220817202349.png><div style=text-align:center><img style=height:ZgotmplZpx;width:ZgotmplZpx class=lazyload src=/svg/loading.min.svg data-src=/blog/dn-1/Pasted%20image%2020220817202349.png data-srcset="/blog/dn-1/Pasted%20image%2020220817202349.png, /blog/dn-1/Pasted%20image%2020220817202349.png 1.5x, /blog/dn-1/Pasted%20image%2020220817202349.png 2x" data-sizes=auto alt=/blog/dn-1/Pasted%20image%2020220817202349.png width=445 height=38></div></a>No, wait. An error. I search through <a href=https://github.com/Perfare/AssetStudio/issues/986>Github Issues</a> and...<blockquote><p>please check <a href=https://github.com/Perfare/AssetStudio#export-monobehaviour target=_blank rel="noopener noreffer">https://github.com/Perfare/AssetStudio#export-monobehaviour</a></p></blockquote><p>Ah. I failed to the documentation.</p><p>Again.</p><p>One installation of <code>Il2CppDumper.exe</code> later, and I create the fake <code>.dll</code> files AssetStudio is looking for:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bat data-lang=bat><span class=line><span class=cl>C<span class=p>:</span><span class=nl>\Program</span><span class=c1> Files\Steam\steamapps\common\Disco Elysium\disco_Data&gt;C:\Program Files\Il2CppDumper-net6-v6.7.25\Il2CppDumper.exe ..\GameAssembly.dll .\il2cpp_data\Metadata\global-metadata.dat C:\il2cpp_out</span>
</span></span><span class=line><span class=cl>Initializing metadata...
</span></span><span class=line><span class=cl>Metadata Version: 27
</span></span><span class=line><span class=cl>Initializing il2cpp file...
</span></span><span class=line><span class=cl>Il2Cpp Version: 27
</span></span><span class=line><span class=cl>Searching...
</span></span><span class=line><span class=cl>Change il2cpp version to: 27.1
</span></span><span class=line><span class=cl>CodeRegistration : 18216e9c0
</span></span><span class=line><span class=cl>MetadataRegistration : 182173350
</span></span><span class=line><span class=cl>Dumping...
</span></span><span class=line><span class=cl>Done!
</span></span><span class=line><span class=cl>Generate struct...
</span></span><span class=line><span class=cl>Done!
</span></span><span class=line><span class=cl>Generate dummy dll...
</span></span><span class=line><span class=cl>Done!
</span></span><span class=line><span class=cl>Press any key to exit...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C<span class=p>:</span><span class=nl>\Program</span><span class=c1> Files\Steam\steamapps\common\Disco Elysium\disco_Data&gt;</span>
</span></span></code></pre></td></tr></table></div></div></div></div></div><hr><p>Re-opening AssetStudio, I follow the README, and&mldr;</p><p align=center><img src=Pasted%20image%2020220817202812.png></p><p>It&rsquo;s there! <code>AssetName</code>, <code>ArticyID</code>. The <code>AssetName</code>s match up with the <code>.wav</code> filenames we extracted, and the <code>ArticyID</code>s match exactly to the expected dialogue for each audio file. Taking the first example in the image, <code>0x010000060001BDCA</code> refers to this part of the massive Dialogue <code>json</code>:<figure><img src=Pasted%20image%2020220817203121.png></figure>With all the information we need (theoretically) in tow, we can move on to <a href=/todo rel>Data Formatting</a>.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on September 11, 2022&nbsp;<a class=git-hash href=https://github.com/152334H/blog/commit/4362c9a2669cb5f6a740e0c529518627222eb30f target=_blank title="commit by 152334H(54623771+152334H@users.noreply.github.com) 4362c9a2669cb5f6a740e0c529518627222eb30f: remove draft status to display posts">
<i class="fas fa-hashtag fa-fw" aria-hidden=true></i>4362c9a</a></span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://152334H.github.io/blog/dn-1/ data-title="Disco Narrator - Data Scraping" data-hashtags="Disco Elysium,reverse engineering,part of a series,WIP"><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://152334H.github.io/blog/dn-1/ data-hashtag="Disco Elysium"><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://152334H.github.io/blog/dn-1/><i class="fab fa-linkedin fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://152334H.github.io/blog/dn-1/ data-title="Disco Narrator - Data Scraping"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://152334H.github.io/blog/dn-1/><i class="fab fa-reddit fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://152334H.github.io/blog/dn-1/ data-title="Disco Narrator - Data Scraping"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://152334H.github.io/blog/dn-1/ data-title="Disco Narrator - Data Scraping"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/disco-elysium/>Disco Elysium</a>,&nbsp;<a href=/tags/reverse-engineering/>reverse engineering</a>,&nbsp;<a href=/tags/part-of-a-series/>part of a series</a>,&nbsp;<a href=/tags/wip/>WIP</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/blog/append-a-newline/ class=prev rel=prev title="Append a newline to your shell prompt"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Append a newline to your shell prompt</a>
<a href=/blog/hosting-pwn-challenges/ class=next rel=next title="Hosting pwn challenges: a simple tutorial">Hosting pwn challenges: a simple tutorial<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=giscus class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://giscus.app>Giscus</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://152334H.github.io/ target=_blank>152334H</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/twemoji@14.0.2/dist/twemoji.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/copy-tex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:10},comment:{giscus:{category:"Announcements",categoryId:"DIC_kwDOH03r284CQ2Tu",darkTheme:"dark_dimmed",emitMetadata:"0",inputPosition:"bottom",lang:"en",lazyLoading:!1,lightTheme:"light",mapping:"pathname",reactionsEnabled:"1",repo:"152334H/152334h.github.io",repoId:"R_kgDOH03r2w"}},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"},twemoji:!0}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W0STJ4D3N3",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=G-W0STJ4D3N3" async></script></body></html>